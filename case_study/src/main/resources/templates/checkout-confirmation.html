<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>X√°c nh·∫≠n ƒë∆°n h√†ng</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .checkout-card {
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
    </style>
</head>

<body>
<div class="container mt-5 pt-5">
    <div class="checkout-card">
        <h2 class="text-center mb-4">üßæ X√°c nh·∫≠n ƒë∆°n h√†ng</h2>

        <!-- Th√¥ng tin kh√°ch h√†ng -->
        <div th:if="${khachHang != null}" class="mb-4">
            <h5 class="mb-3">Th√¥ng tin kh√°ch h√†ng</h5>
            <p><strong>H·ªç t√™n:</strong> <span th:text="${khachHang.hoTen}"></span></p>
            <p><strong>Email:</strong> <span th:text="${khachHang.email}"></span></p>
            <p><strong>S·ªë ƒëi·ªán tho·∫°i:</strong> <span th:text="${khachHang.soDienThoai}"></span></p>
            <p><strong>ƒê·ªãa ch·ªâ:</strong> <span th:text="${khachHang.diaChi}"></span></p>
        </div>

        <!-- Danh s√°ch s·∫£n ph·∫©m -->
        <h5 class="mb-3">Chi ti·∫øt s·∫£n ph·∫©m</h5>
        <table class="table table-bordered table-hover">
            <thead class="table-secondary">
            <tr>
                <th>T√™n laptop</th>
                <th>S·ªë l∆∞·ª£ng</th>
                <th>ƒê∆°n gi√°</th>
                <th>Th√†nh ti·ªÅn</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="item : ${selectedItems}">
                <td th:text="${item.tenLaptop}"></td>
                <td th:text="${item.soLuong}"></td>
                <td th:text="${#numbers.formatDecimal(item.gia, 0, 'COMMA', 0, 'POINT')} + ' VNƒê'"></td>
                <td th:text="${#numbers.formatDecimal(item.tongTien, 0, 'COMMA', 0, 'POINT')} + ' VNƒê'"></td>
            </tr>
            </tbody>
        </table>

        <!-- T·ªïng ti·ªÅn -->
        <h5 class="text-end text-primary mt-4">
            T·ªïng ti·ªÅn:
            <span th:text="${#numbers.formatDecimal(tongTien, 0, 'COMMA', 0, 'POINT')} + ' VNƒê'"></span>
        </h5>

        <!-- Form x√°c nh·∫≠n -->
        <form th:action="@{/cart/confirm}" method="post" class="text-end mt-4" onsubmit="return handleSubmit(this)">
            <div th:each="item : ${selectedItems}">
                <input type="hidden" name="ids" th:value="${item.id}" />
            </div>
            <a th:href="@{/cart}" class="btn btn-secondary me-2">Quay l·∫°i gi·ªè h√†ng</a>

            <!-- N√∫t x√°c nh·∫≠n -->
            <button type="submit" class="btn btn-success" id="submitButton">
                <span class="spinner-border spinner-border-sm me-1 d-none" id="spinner" role="status" aria-hidden="true"></span>
                <span id="buttonText">X√°c nh·∫≠n mua h√†ng</span>
            </button>
            <div class="form-group text-start mt-3">
                <label for="phuongThucThanhToan"><strong>Ph∆∞∆°ng th·ª©c thanh to√°n:</strong></label>
                <select class="form-select" id="phuongThucThanhToan" name="phuongThucThanhToan" required>
                    <option value="Tien_mat">Ti·ªÅn m·∫∑t</option>
                    <option value="Chuyen_khoan">Chuy·ªÉn kho·∫£n</option>
                    <option value="The_tin_dung">Th·∫ª t√≠n d·ª•ng</option>
                    <option value="Vi_dien_tu">V√≠ ƒëi·ªán t·ª≠</option>
                </select>
            </div>


        </form>

        <!-- Script x·ª≠ l√Ω khi submit -->
        <script>
            function handleSubmit(form) {
                const button = document.getElementById('submitButton');
                const spinner = document.getElementById('spinner');
                const text = document.getElementById('buttonText');

                spinner.classList.remove('d-none'); // Hi·ªán spinner
                text.textContent = 'ƒêang x·ª≠ l√Ω...'; // ƒê·ªïi n·ªôi dung
                button.disabled = true; // V√¥ hi·ªáu ho√° n√∫t
                return true; // Ti·∫øp t·ª•c submit form
            }
        </script>


    </div>
</div>
</body>
</html>
